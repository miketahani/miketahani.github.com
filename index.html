<!doctype html>
<html>
  <head>
    <meta charset='utf-8'>
    <style>

      body {
        font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
        font-size: 1.5em;
        margin: 20px;
      }

      svg {
        margin: 0;
        padding: 0;
      }

      #threed {
        position: fixed;
        top: 0;
        left: 0;
        z-index: -1;
      }

      a {
        padding: 0 1px;
      }

      a, a:visited {
        text-decoration: none;
        background: #000;
        color: #fff;
        line-height: 1.3em;
      }

      a:hover {
        padding: 0 10px 0 20px;
        /*background: #000;*/
      }

      #header {
        font-size: 2em;
      }

      .smaller {
        font-size: 0.7em;
        padding-top: 20px;
      }

    </style>
  </head>
  <body>

    <div id='main'>
      <div id='header'>
        Mike Tahani
      </div>
      Creative Technologist at-large

      <p>
        <a href='http://datahacker.tumblr.com'>Portfolio</a><br>
        <a href='http://github.com/miketahani'>Github</a><br>
        <a href='http://twitter.com/mtahani'>Twitter</a><br>
      </p>

      <p class='smaller'>
        say hi: "me" [at] this domain
      </p>
    </div>

    <div id='threed'></div>

    <script src='js/d3.v3.js'></script>
    <script src='js/three.r65.js'></script>
    <script>

      var scene = new THREE.Scene();
      var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
      
      var renderer = new THREE.WebGLRenderer();
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setClearColor(0xffffff);
      document.getElementById('threed').appendChild(renderer.domElement);
      
      var geometry = new THREE.IcosahedronGeometry();
      var material = new THREE.MeshBasicMaterial({
        color: 0xaaaaaa, 
        wireframe: true 
        // transparent: true, 
        // opacity: 0.5
      });
      var inner = new THREE.Mesh(geometry, material);
      scene.add(inner);

      var geometry = new THREE.IcosahedronGeometry(2.5);
      var material = new THREE.MeshBasicMaterial({
        color: 0x000000, 
        wireframe: true, 
        transparent: true, 
        opacity: 0.3,
      });
      var outer = new THREE.Mesh(geometry, material);
      outer.userData.velocity = 0.1;
      outer.userData.opacity = 0.1;
      scene.add(outer);

      
      camera.position.z = 5;
      
      var render = function () {
        requestAnimationFrame(render);
      
        inner.rotation.x += 0.01;
        inner.rotation.y += 0.01;

        outer.rotation.x -= 0.005;
        outer.rotation.y -= 0.005;

        renderer.render(scene, camera);
      };
      
      render();

      var expandOuter,
          innerToWireframe,
          v = 0.02,
          scale = 1;

      var a = d3.select('body')
        .selectAll('a');

       a 
        .on('mouseover', function() {
          window.clearInterval(expandOuter);
          if (innerToWireframe)
            window.clearTimeout(innerToWireframe);

          var hue = Math.random();

          inner.material.color.setHSL(hue, 1.0, 0.65);
          inner.material.wireframe = false;

          var color = 'hsl(' + hue * 360 + ', 100%, 65%)';

          d3.select(this).style('color', color);

          expandOuter = window.setInterval(function() {
            if (scale < 2) {
              scale += v;
            }
            else {
              window.clearInterval(expandOuter);
              scale = 2;
            }
            outer.scale.set(scale, scale, scale);
          }, 0);
        })
        .on('mouseout', function() {
          d3.select(this).style('color', 'white');

          innerToWireframe = window.setTimeout(function() {
            
            inner.material.wireframe = true;

            window.clearInterval(expandOuter);
            expandOuter = window.setInterval(function() {
              if (scale > 1) {
                scale -= v;
              }
              else {
                scale = 1;
                window.clearInterval(expandOuter);
              }
              outer.scale.set(scale, scale, scale);
            }, 0);

          }, 200);
        });

    </script>

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-47985420-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

  </body>
</html>